<h2><%= @game.name %></h2>
<p>Available for <%= @game.platform %> - <%= @game.rating %></p>
<p><%= @game.description %></p>

<% if @game.reviews.first.user == current_user %>
    <%= button_to 'Edit Game', edit_game_path(@game), method: :get %>
    <%= button_to 'Delete Game', game_path(@game), method: :delete, data: { confirm: 'Are you sure you want to delete this game and all its reviews?' } %>
<% else %>
    <%= button_to 'Write Review', new_game_review_path(@game), method: :get %>
<% end %>

<br>
_________________________________________________________

<br><h2>Reviews</h2>

<%= form_tag(games_select_user_path) do %>
    <%= hidden_field_tag 'game', @game.id %>
    <%= select_tag 'user_id', options_from_collection_for_select(@users, "id", "first_name") %>
    <%= submit_tag "Find User" %>
<% end %>

<% if @user %>
    <% @user.reviews.find_all{|r| r.game_id == @game.id}.each do |review| %>
        <div class="review">
            <h3><%= review.title %></h3>
            <h4><%= review.rating %> Star(s) - <%= rec(review) %></h4>
            <p><%= review.content %></p>
            <h5>written by <%= review.user.first_name %></h5>
        </div><br>  
    <% end %>

    <%= button_to 'See All Reviews', game_path(@game), method: :get %>
    
<% else %>
    <% @game.reviews.each do |review| %>
        <div class="review">
            <h3><%= review.title %></h3>
            <h4><%= review.rating %> Star(s) - <%= rec(review) %></h4>
            <p><%= review.content %></p>
            <h5>written by <%= review.user.first_name %></h5>
        </div><br>   
    <% end %>
<% end %>

<% if !user_signed_in? %>
    <h3>Cannot find what you are looking for? <%= link_to 'Sign Up', new_user_registration_path %> or <%= link_to 'Log In', new_user_session_path %> and create your own Games and Reviews!</h3> 
<% end %>